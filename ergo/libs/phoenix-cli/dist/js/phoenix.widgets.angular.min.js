!function(e){if(angular){var o=e.locale,t=e.ui;angular.module("phoenix.ui").directive("highcharts",[function(){return{scope:{config:"=",data:"="},restrict:"E",replace:!0,template:'<div style="width:100%; height: 100%;"></div>',link:function(e,o,t){e.$watchGroup(["data","config.type","config.options"],function(){if(e.data){n.constructeDefaultConfig(e),n.constructeChartByType(e,e.config.type),n.constructeData(e),n.constructeUserOptions(e),o.css("height",e.config.height),e.chartConfig.chart.renderTo=o.get(0);var t=new window.Highcharts.Chart(e.chartConfig),a=function(){t&&t.options&&t.reflow()};$(window).on("phoenix-resize",a),e.$on("$destroy",function(){if(t){try{$(window).off("phoenix-resize",a),t.destroy(),t=null}catch(e){}window.setTimeout(function(){o.remove()},0)}})}},!0)}}}]);var n={constructeDefaultConfig:function(e){t.translateHighcharts(),e.config.type=e.config.type||"pie",e.chartConfig={chart:{type:e.config.type,plotBackgroundColor:null,plotBorderWidth:0,plotShadow:!1,reflow:!0},tooltip:{pointFormat:r.addToolTipPointFormat(e.config,"<b>{point.y:,.2f} "+o.number.symbol+"</b>"),headerFormat:r.addToolTipHeaderFormat(e.config,"point.key"),style:{padding:10,fontWeight:"bold"}},legend:{itemStyle:{cursor:"default"}},credits:{enabled:!1},lang:{decimalPoint:o.number.decimal},plotOptions:{series:{allowPointSelect:!1}},colors:[],series:[],title:{text:""}},e.chartConfig.plotOptions[e.config.type]={allowPointSelect:!0,cursor:"pointer",dataLabels:r.addLabel(e.config,"{point.percentage:,.2f}%"),showInLegend:!0,events:{legendItemClick:function(e){return!1}},point:{events:{legendItemClick:function(e){return!1}}},size:e.config.size||"50%"},e.colors=e.config.colors&&Array.isArray(e.config.colors)?e.config.colors:["#f03558","#fad32d","#45cebd","#f99f46","#6A5ACD","#A0522D","#000000","#696969"],e.chartConfig.colors=e.colors},constructeChartByType:function(e,t){switch(t){case"column":e.chartConfig.tooltip.headerFormat=r.addToolTipHeaderFormat(e.config,"series.name"),e.chartConfig.plotOptions.column.dataLabels=r.addLabel(e.config,"{point.y:,.0f} "+o.number.symbol),e.chartConfig.xAxis={gridLineWidth:0,minorGridLineWidth:0,title:{text:null},labels:{enabled:!0},minorTickLength:0,tickLength:0},e.chartConfig.yAxis={min:0,margin:[0,0,0,0],gridLineWidth:2,gridLineDashStyle:"Dot",title:{text:null,style:{display:"none"},margin:[0,0,0,0]}};break;case"columnrange":e.chartConfig.chart.inverted=!0,e.chartConfig.tooltip={pointFormat:r.addToolTipPointFormat(e.config,"{point.low:%d/%m/%Y} - {point.high:%d/%m/%Y}"),style:{padding:10,fontWeight:"bold"}},e.chartConfig.exporting={enabled:!1},e.chartConfig.legend=e.chartConfig.legend||{},e.chartConfig.legend.enabled=!1,e.chartConfig.plotOptions.columnrange.dataLabels=r.addLabel(e.config,"point.y:%d/%m/%Y"),e.chartConfig.plotOptions.columnrange.colorByPoint=!0,e.chartConfig.plotOptions.columnrange.borderWidth=0,e.chartConfig.xAxis={gridLineWidth:2,gridLineDashStyle:"Dot"},e.chartConfig.yAxis={title:{text:null},type:"datetime",tickInterval:31536e6,minorTickInterval:31536e6,dateTimeLabelFormats:{year:"%Y"},gridLineWidth:5,gridLineColor:"#eee"};var n=new Date;e.chartConfig.yAxis.plotLines=[{color:"#747679",width:2,value:n}]}},constructeUserOptions:function(e){e.config.options&&(e.chartConfig=r.addOptions(e.chartConfig,e.config.options))},constructeData:function(e){e.chartConfig.xAxis=e.chartConfig.xAxis||{},e.chartConfig.xAxis.categories=[],e.data.series?e.chartConfig.series=e.data.series:e.data.rows?(e.chartConfig.data=e.chartConfig.data||{},e.chartConfig.data.firstRowAsNames=!1,e.chartConfig.data.rows=e.data.rows||[],e.chartConfig.series=[],e.data.cols.slice(1).forEach(function(o){e.chartConfig.series.push({name:o.label})})):e.data.datapoints&&(e.chartConfig.series=a.formateDatapoints(e.data)),(e.data.datapoints||e.data.series)&&e.chartConfig.series>1&&e.chartConfig.series.forEach(function(o){e.chartConfig.xAxis.categories.push(o.name)})}},a={formateDatapoints:function(e){if(!e.datapoints.length)return o;var o=[];return e.datapoints[0].length>2?e.datapoints.forEach(function(e){var t=-1;o.forEach(function(o,n){if(o.name==e[0])return t=n}),t>-1?o[t].data.push([e[1],e[2]]):o.push({name:e[0],data:[[e[1],e[2]]]})}):(o[0]={name:"",data:[]},e.datapoints.forEach(function(e){o[0].data.push([e[0],e[1]])})),o}},r={addToolTipHeaderFormat:function(e,o){return e.tooltip&&e.tooltip.headerFormat?e.tooltip.headerFormat:'<span style="font-size: 11px;font-weight:normal">{'+o+"}</span><br/>"},addToolTipPointFormat:function(e,o){return e.tooltip&&e.tooltip.pointFormat?e.tooltip.pointFormat:o},addLabel:function(e,o){return e.label?{enabled:void 0===e.label.visible||e.label.visible,format:e.label.format||o}:{enabled:!0,format:o}},addOptions:function(e,o){if(angular.isArray(o)){e=angular.isArray(e)?e:[];for(var t=0;t<o.length;t++)e[t]=this.addOptions(e[t]||{},o[t])}else if(angular.isObject(o))for(var n in o)e[n]=this.addOptions(e[n]||{},o[n]);else e=o;return e}}}}(Phoenix||(Phoenix={}));!function(e){if(angular){var o=e.customData,t=angular.module("phoenix.ui");t.controller("uiWidgetPhoenixchartController",["$scope",function(e){e.chart=e.props.data.chart||{},e.chart.search=e.chart.search||!1,e.props.data.chart.height=e.chart.height||e.props.$height-(e.props.data.chart.search?30:0);var t=e.chart.dataset||"dataset";e.$watch("data."+t,function(){if(e.data&&e.data[t]){if(e.data[t].cols){var n=e.data.view&&e.data.view[t]?e.data.view[t]:null;e.data[t].cols.forEach(function(e){e.label=n&&n[e.name]&&n[e.name].title?n[e.name].title:e.label||e.name})}var a=o.get("highcharts.transform."+e.chart.transformData);e.series=a?a(e.data[t].documents||e.data[t],e):e.data[t]}}),e.chart.options=e.chart.options||{},e.phone&&e.chart.axeXInvisible&&(e.chart.options.xAxis=e.chart.options.xAxis||{},e.chart.options.xAxis.labels={enabled:!1})}]),t.directive("widgetPhoenixchart",[function(){return{scope:{props:"=",data:"=",module:"=",phone:"="},restrict:"E",controller:"uiWidgetPhoenixchartController",template:'<select class="form-control" ng-show="chart.search" ng-model="props.data.chart.type"><option>pie</option><option>column</option></select><highcharts config="props.data.chart" data="series"></highcharts>'}}])}}(Phoenix||(Phoenix={}));!function(e){if(angular){var o=e.utils,t=(e.render,e.ui),n=function(){o.log("destroy form","scope"),this.component&&this.component.destroy()};(a=angular.module("phoenix.ui")).controller("uiFormController",["$scope",function(e){}]),a.directive("bsform",[function(){return{scope:{module:"=",layout:"=",prototype:"=",meta:"=",data:"=",action:"=",beforeSetModel:"=",init:"=",storage:"=",validators:"=",onsettings:"="},bindToController:!0,restrict:"E",replace:!1,controller:"uiFormController",controllerAs:"module",link:function(e,o,a){var r=e.$new();r.component=new t.FormContainer({replaceParent:!0,context:"angular",beforeAdd:function(e,o){},beforeRemove:function(o){var t=r.component,a=r.module;r.component=null,r.module=null,r.$destroy();var i=e.$new();r.component=null,i.component=t,i.module=a,i.$on("$destroy",n.bind(i)),r=i},beforeSetModel:r.module.beforeSetModel,afterModelCreated:r.module.init,onSettings:r.module.onsettings,storageName:r.module.storage,validators:r.module.validators},r.module.layout,r.module.meta||r.module.prototype,r.module.data,r.module.module),r.component.action=r.module.action,r.component.render(o),r.$on("$destroy",n.bind(r))}}}]);var a;(a=angular.module("phoenix.ui")).controller("uiFormCtrlController",["$scope",function(e){}]),a.directive("widgetForm",[function(){return{scope:{module:"="},bindToController:!0,restrict:"E",replace:!0,controller:"uiFormCtrlController",controllerAs:"module",link:function(e,o,a){var r=e.$new(),i=r.module.module.data.form;r.component=new t.FormContainerController({replaceParent:!0,context:"angular",beforeAdd:function(e,o){},beforeRemove:function(o){var t=r.component,a=r.module;r.component=null,r.module=null,r.$destroy();var i=e.$new();r.component=null,i.component=t,i.module=a,i.$on("$destroy",n.bind(i)),r=i}},i.name,i.meta,i.controller,r.module.module),r.component.render(o),r.$on("$destroy",n.bind(r))}}}])}}(Phoenix||(Phoenix={}));!function(e){if(angular){var o=e.utils,t=e.ui;angular.module("phoenix.ui").directive("googlechart",[function(){return{scope:{data:"=",config:"="},restrict:"E",replace:!0,link:function(e,n,a){e.component=new t.GoogleChart({replaceParent:!0}),e.component.props.config=e.config,e.component.props.data=e.data,e.component.render(n),e.$on("$destroy",function(){o.log("destroy google chart","scope"),e.component&&e.component.destroy()}),e.$watch("data",function(){e.component.props.data=e.data})}}}])}}(Phoenix||(Phoenix={}));!function(e){if(angular){var o=e.utils,t=e.ui;angular.module("phoenix.ui").directive("headerMenu",[function(){return{scope:{bodyPlace:"@",backButton:"=",logoutButton:"=",leftMenuButton:"=",leftMenuPlace:"@",topMenuButton:"=",rightMenuButton:"=",topMenuPlace:"@",rightMenuPlace:"@"},restrict:"E",replace:!0,compile:function(e,n){return{pre:function(e,n,a){var r={bodyId:e.bodyPlace,backButton:e.backButton,leftMenuButton:e.leftMenuButton,rightMenuButton:e.rightMenuButton,topMenuButton:e.topMenuButton,leftMenuPlace:e.leftMenuPlace,rightMenuPlace:e.rightMenuPlace,topMenuPlace:e.topMenuPlace,disconnectButton:e.logoutButton,replaceParent:!0};e.component=new t.Header({},r),e.component.render(n),e.$on("$destroy",function(){o.log("destroy header","scope"),e.component&&e.component.destroy()})},post:function(e,o,t){}}}}}])}}(Phoenix||(Phoenix={}));!function(e){if(angular){angular.module("phoenix.ui").directive("widgetHtml",["$compile",function(e){return{scope:{props:"=",data:"="},restrict:"E",replace:!0,link:function(o,t,n){var a=angular.element("<div ng-include=\"'"+o.props.data.template+'\'" props="props" data="data"></div>');e(a)(o),t.replaceWith(a)}}}])}}(Phoenix||(Phoenix={}));!function(e){if(angular){var o=e.utils,t=e.iframe;angular.module("phoenix.ui").directive("widgetIframe",[function(){return{scope:{module:"="},restrict:"E",replace:!0,compile:function(e,n){return{pre:function(e,n,a){e.component=new t.IFrame({replaceParent:!0,src:e.module.props.data.src}),e.component.render(n),e.$on("$destroy",function(){o.log("destroy iframe","scope"),e.component&&e.component.destroy()})}}}}}])}}(Phoenix||(Phoenix={}));!function(e){if(angular){var o=e.utils,t=e.ui;angular.module("phoenix.ui").directive("widgetImageMenuItem",[function(){return{scope:{module:"=",authoring:"="},restrict:"E",replace:!0,compile:function(e,n){return{pre:function(e,n,a){e.component=new t.ImageMenuItem({},$.extend(!0,{replaceParent:!0,authoring:e.authoring},e.module.props.data.menu)),e.component.module=e.module,e.component.render(n),e.$on("$destroy",function(){o.log("destroy image menu item","scope"),e.component&&e.component.destroy()})},post:function(e,o,t){}}}}}])}}(Phoenix||(Phoenix={}));!function(e){if(angular){e.customData;angular.module("phoenix.ui").directive("widgetPhoenixMap",[function(){return{scope:{props:"=",data:"=",module:"="},restrict:"E",controller:["$scope",function(e){e.props.data.map.height=e.props.data.map.height||e.props.$height||400,e.callback=function(o){o?e.module.noData(!1):e.module.noData(!0)}}],template:'<map ng-style="{\'height\': props.data.map.height + \'px\'}" config="props.data.map" address="data.dataset.address" callback="callback"></map>'}}])}}(Phoenix||(Phoenix={}));!function(e){if(angular){e.utils;var o=e.ui,t=e.dom;angular.module("phoenix.ui").directive("map",[function(){return{scope:{config:"=",address:"=",callback:"="},restrict:"E",template:'<div class="bs-map" ng-style="{\'height\': config.height + \'px\'}"  ng-hide="nodata"></div>',controller:["$scope",function(e){e.config.height=e.config.height||400}],link:function(e,n,a){var r=t.query(n.get(0),".bs-map");e.map=null,e.config=e.config||{};var i=e.config.type;e.config.type="gm"==i||"gmap"==i?"gmap":"omap",e.$watch("address",function(){if(e.address){if(!e.map)switch(e.config.type){case"gmap":e.map=o.createMapService({type:"gmap"},e.callback);break;case"omap":e.map=o.createMapService({type:"omap"},e.callback)}e.map&&(e.map.map||e.map.initMap(r),e.map.addMarkerByAddress(e.address))}},!0)}}}])}}(Phoenix||(Phoenix={}));!function(e){if(angular){var o=e.utils,t=e.ui;angular.module("phoenix.ui").directive("moduleTitle",[function(){return{scope:{data:"="},restrict:"E",replace:!0,compile:function(e,n){return{pre:function(e,n,a){e.component=new t.ModuleTitle({replaceParent:!0},e.data),e.component.render(n),e.$on("$destroy",function(){o.log("destroy tabs","scope"),e.component&&e.component.destroy()})}}}}}])}}(Phoenix||(Phoenix={}));var Phoenix;!function(e){if(angular){var o=e.utils,t=e.tabs,n=angular.module("phoenix.ui");n.directive("tabs",[function(){return{scope:{tabs:"="},restrict:"E",replace:!0,compile:function(e,n){return{pre:function(e,n,a){e.component=new t.Tabs({replaceParent:!0},e.tabs),e.component.render(n),e.$on("$destroy",function(){o.log("destroy tabs","scope"),e.component&&e.component.destroy()})}}}}}]),n.directive("widgetTabs",[function(){return{scope:{module:"="},restrict:"E",replace:!0,compile:function(e,n){return{pre:function(e,n,a){e.component=new t.Tabs({replaceParent:!0},e.module.props.data.tabs),e.component.render(n),e.$on("$destroy",function(){o.log("destroy tabs","scope"),e.component&&e.component.destroy()})}}}}}])}}(Phoenix||(Phoenix={}));
//# sourceMappingURL=phoenix.widgets.angular.min.js.map