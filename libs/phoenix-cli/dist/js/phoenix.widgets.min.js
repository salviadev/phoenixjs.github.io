var Phoenix;!function(a){var b;!function(b){var c=a.utils,d=a.dom,e=a.device,f=(a.render,function(a,b){a.appendChild($('<h4 class="title">Photo : '+b.title+"</h4>").get(0));var c=$("<div></div>").get(0);c.appendChild($('<img alt="Pas de photo" src="'+b.url+'" />').get(0)),a.appendChild(c)}),g=['<div id="{0}" class="carousel bs-carousel">','<ol class="carousel-indicators"></ol>','<div class="carousel-inner"></div>',c.format('<a data-slide="prev" data-target="#{0}" class="left carousel-control" style="cursor:pointer;"><span class="{0}"></span></a>',d.iconClass("chevron-left")),c.format('<a data-slide="next" data-target="#{0}" class="right carousel-control" style="cursor:pointer;"><span class="{0}"></span></a>',d.iconClass("chevron-right")),"</div>"],h=function(){function a(a){var b=this;b.options=a||{},b.props={},b.data={slides:[]},b.carouselId=c.allocID(),b._defineProps()}return a.prototype._defineProps=function(){var a=this,b=c.defineProperty;b("slides",a)},a.prototype._notifyChange=function(a){var b=this;switch(a){case"slides":b._createSlides()}},a.prototype._renderSlide=function(a,b){return"image"==b.$type?f(a,b):void a.appendChild($('<div style="min-height:200px; background-color: red;"><center>Invalid slide definition.</center></div>').get(0))},a.prototype._createSlides=function(){var a=this;if(a.$element){var b=a.$element.get(0),c=d.query(b,".carousel-indicators"),e=d.query(b,".carousel-inner");$(c).empty(),$(e).empty();var f=document.createDocumentFragment(),g=document.createDocumentFragment(),h=$('<li data-slide-to="1" data-target="#'+a.carouselId+'"></li>').get(0),i=$('<div class="item"></div>').get(0);a.data.slides.forEach(function(b,c){var e=h.cloneNode(!0),j=i.cloneNode(!0);d.attr(e,"data-slide-to",c),c||(d.addClass(e,"active"),d.addClass(j,"active")),f.appendChild(e),a._renderSlide(j,b),g.appendChild(j)}),a.data.slides.length?(c.appendChild(f),e.appendChild(g),d.removeClass(b,"bs-none")):d.addClass(b,"bs-none"),a.$element.carousel("pause")}},a.prototype._setEvents=function(){var a=this;a.$element&&a.$element.swipe&&"windows"!=e.deviceType&&a.$element.swipe({excludedElements:" button, input, select, textarea, .noSwipe",swipeLeft:function(b){a.$element.carousel("prev")},swipeRight:function(b){a.$element.carousel("next")}})},a.prototype._removeEvents=function(){var a=this;a.$element&&a.$element.swipe&&"windows"!=e.deviceType&&a.$element.swipe("destroy")},a.prototype.render=function(a){var b=this;return b.$element||(b.$element=$(c.format(g.join(""),b.carouselId)),b._createSlides(),b._setEvents()),a&&(b.options.replaceParent?a.replaceWith(b.$element):a.append(b.$element)),b.$element},a.prototype.destroy=function(){var a=this;a._removeEvents(),a.$element=null,a.options=null},a}();b.Carousel=h}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var Phoenix;!function(a){var b;!function(b){var c=a.ulocale,d=a.locale,e=function(a){window.Highcharts&&window.Highcharts.setOptions&&window.Highcharts.setOptions({lang:{months:d.date.months,weekdays:d.date.weekdays,shortMonths:d.date.monthsShort,decimalPoint:d.number.decimal,thousandsSep:d.number.thousand,resetZoom:d.charts.resetZoom,resetZoomTitle:d.charts.resetZoomTitle,rangeSelectorZoom:d.charts.rangeSelectorZoom,rangeSelectorFrom:d.charts.rangeSelectorFrom,rangeSelectorTo:d.charts.rangeSelectorTo}})},f=function(){var a="";return function(){c.currentLang!=a&&(a=c.currentLang,e(c.currentLang))}};b.translateHighcharts=f()}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Phoenix;!function(a){var b;!function(b){var c=a.utils,d=(a.dom,a.locale,a.$mem,a.link,b),e=a.customData,f=a.render,g=function(){function a(a,b,c,d,e){var f=this;a=a||{},f.formData=d||{$create:!0},f.options=a,f.layout=b,f.schema=c,f.module=e}return a.prototype.render=function(a){var b=this;if(!b.$element){var c={replaceParent:b.options.replaceParent,context:b.options.context,beforeAdd:b.options.beforeAdd,beforeRemove:b.options.beforeRemove,beforeSetModel:b.options.beforeSetModel,afterModelCreated:b.options.afterModelCreated,settingsHandler:b.options.onSettings,storageName:b.options.storageName,validators:b.options.validators,module:b.module},e=b.module&&b.module.data&&b.module.data.data&&b.module.data.data.ds&&b.module.data.data.ds.view?b.module.data.data.ds.view.$view:null;d.OpenForm(a,b.layout,b.schema,b.formData||{},e,b.action,c,function(a){b.form=a,b.$element=b.form.$element})}},a.prototype.destroy=function(){var a=this;a.form&&(a.form.destroy(),a.form=null),a.$element=null},a}();b.FormContainer=g,f.register("javascript","widget.content.control.form",g);var h=function(a){function d(d,f,g,h,i){var j;if(!f)throw"Form name is empty.";if(!g)throw"Meta name (schema) is empty.";if(!h)throw"Controller name is empty.";var k=e.get(h);if(!k)throw c.format('Controller not found "{0}". Use customData.register(controllerName, ctrlConfig).',h);b.formController2Options(d,k);var l=k.data?k.data():null;return j=a.call(this,d,f,g,l,i)||this,k.isFormController?j.action=k.modelChanged.bind(k):k.onModelChanged&&(j.action=k.onModelChanged.bind(k)),j}return __extends(d,a),d}(g);b.FormContainerController=h}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var Phoenix;!function(a){var b;!function(b){var c=a.ulocale,d=a.utils,e=a.ajax,f=a.render,g='<div id="{0}" class="" style="width:{1};height:{2}"></div>',h=function(a,b,d){var e=new window.google.visualization.DataTable;e.addColumn("string","Id"),e.addColumn("string","Name"),e.addColumn("date","Start"),e.addColumn("date","End");for(var f=[],g=1,h=a.cols.length;g<h;g++){var i=new Array(4);i[0]=g+"",i[1]=a.cols[g].label;var j=a.rows[0][g];j="object"==typeof j?j.value:j,j?i[2]=c.parseISODate(j):i[2]=null,j=a.rows[1][g],j="object"==typeof j?j.value:j,j?i[3]=c.parseISODate(j):i[3]=null,f.push(i)}return b.timeline={showRowLabels:!1},b.colors=d.colors,e.addRows(f),e},i=function(a,b,d){var e="money"==d.valueType,f=new window.google.visualization.DataTable;a.titles=a.titles||{},a.rows=a.rows||[],f.addColumn("string",a.cols[0].label),f.addColumn("number",a.titles.seriesTitle||"");for(var g=[],h=1,i=a.cols.length;h<i;h++){for(var j=[a.cols[h].label,{v:0,f:""}],k=0,l=a.rows.length;k<l;k++){var m=a.rows[k][h];m&&(j[1].v+="object"==typeof m?m.value:m)}j[1].v=parseFloat(j[1].v.toFixed(6)),e&&(j[1].f=c.money(j[1].v,!0)),g.push(j)}return f.addRows(g),d.colors&&(b.slices={},d.colors.forEach(function(a,c){b.slices[c]={color:a}})),f},j=function(a,b,d){var e="money"==d.valueType,f=new window.google.google.visualization.DataTable,g=[];a.titles=a.titles||{},a.rows=a.rows||[];for(var h=0,i=a.cols.length;h<i;h++)f.addColumn(h?"number":"string",a.cols[h].label);for(var j=0,k=a.rows.length;j<k;j++){for(var l=new Array(a.cols.length),h=0,i=a.cols.length;h<i;h++){var m=a.rows[j][h];0==h?l[h]="object"==typeof m?m.value:m:(l[h]={v:"object"==typeof m?m.value:m},e&&(l[h].f=c.money(l[h].v,!0)))}g.push(l)}return b.colors=d.colors,f.addRows(g),f},k=function(){function a(a){var b=this;b.options=a||{},b.props={},b.data={},b.chartId=d.allocID(),b._defineProps()}return a.prototype._defineProps=function(){var a=this,b=d.defineProperty;b("data",a),b("config",a)},a.prototype._notifyChange=function(a){var b=this;switch(a){case"data":b.renderChart()}},a.prototype._onresize=function(){var a=this;a._internalRenderChart()},a.prototype._setEvents=function(){var a=this;a.$element&&$(window).on("resize."+a.chartId,function(){a.canResize&&(clearTimeout(a.doResize),a.doResize=setTimeout(a._onresize.bind(a),100))})},a.prototype._removeEvents=function(){var a=this;a.$element&&$(window).off("resize."+a.chartId)},a.prototype._getConfig=function(){var a=this,b=a.data.config||{};return b.width=(b.width||"100%")+"",b.height=(b.height||"400px")+"",(b.height.indexOf("px")<0||b.height.indexOf("%")<0)&&(b.height=b.height+"px"),b},a.prototype._append=function(a){var b=this;a&&(b.options.beforeAdd&&b.options.beforeAdd(b.$element),b.options.replaceParent?a.replaceWith(b.$element):a.append(b.$element))},a.prototype.renderChart=function(){var a=this;a.$element&&(a.rto||(a.rto=window.setTimeout(function(){a.rto=null,a._internalRenderChart()},0)))},a.prototype._internalRenderChart=function(){var a=this,b=a.data.config||{};b.valueType=b.valueType||"money",b.colors=b.colors||["#f03558","#fad32d","#45cebd","#f99f46","#6A5ACD","#A0522D","#000000","#696969"],b.colors=["#f03558","#fad32d","#45cebd","#f99f46","#6A5ACD","#A0522D","#000000","#696969"];var c,d,e=a.data.data,f={legend:{position:"top",alignment:"center",maxLines:2},tooltip:{showColorCode:!0,text:"value"},pieHole:0,vAxis:null,hAxis:null,bars:""};if(a.$element.empty(),e&&e.cols&&e.cols.length&&e.rows&&e.rows.length){switch(b.type){case"pie":d="PieChart",c=i(e,f,b);break;case"donut":d="PieChart",c=i(e,f,b),f.pieHole=.4;break;case"line":d="LineChart",f.hAxis={title:e.cols[0].label||""},f.vAxis={title:e.titles.valuesTitle||""},c=j(e,f,b);break;case"area":d="AreaChart",f.hAxis={title:e.cols[0].label||""},f.vAxis={title:e.titles.valuesTitle||""},c=j(e,f,b);break;case"bar":d="BarChart",f.hAxis={title:e.titles.valuesTitle||""},f.vAxis={title:e.cols[0].label||""},f.bars="horizontal",c=j(e,f,b);break;case"column":d="ColumnChart",f.hAxis={title:e.cols[0].label||""},f.vAxis={title:e.titles.valuesTitle||""},c=j(e,f,b);break;case"columnrange":if(d="Timeline",2!=e.rows.length)return null;c=h(e,f,b);break;default:return null}var g="Bar"==d?new window.google.charts.Bar(a.$element.get(0)):new window.google.visualization[d](a.$element.get(0));g.draw(c,f),a.canResize=!0}},a.prototype.render=function(a){var b=this;b.$element?b._append(a):e.loadScript("jsapi","https://www.google.com/jsapi",function(c){if(!c){var f={execute:function(a){window.google.load("visualization","1",{packages:["corechart","timeline"],callback:a})}};e.loadScript("gvisualization","",function(c){var e=b._getConfig();b.$element=$(d.format(g,b.chartId,e.width,e.height)),b._append(a),b.renderChart(),b._setEvents()},f)}},null)},a.prototype.destroy=function(){var a=this;a._removeEvents(),a.$element=null,a.options=null},a}();b.GoogleChart=k,f.register("javascript","widget.content.control.googlechart",k)}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var Phoenix;!function(a){var b;!function(b){var c=a.utils,d=a.dom,e=a.locale,f=a.$mem,g=a.link,h=b,i=a.customData,j=a.render,k=["<div>",'   <div class="bs-lv-search bs-none">',"        <div>",'           <div class="input-group input-group-lg">','               <input type="text" class="form-control bs-lv-search-input" placeholder="{0}">','               <span class="input-group-btn">','                   <button class="bs-button btn btn-default bs-lv-search-btn" type="button"><span class="'+d.iconClass("search")+'"></span></button>',"               </span>","           </div>","        </div>","   </div>","   {1}",'   <center><nav class="bs-lv-pagination">',"   </nav></center>",'   <center><div class="bs-lv-nodata bs-none">'+e.listView.search.Nodata+"</div></center>","</div>"],l='<div class="bs-lv-content list-group"></div>',m='<a draggable="false" href="#" class="list-group-item"></a>',n="<div></div>",o='<div class="list-group-item"></div>',p=function(a,b){return a=a||e.listView.search.Search,$(c.format(k.join(""),a,b))},q=function(a,b,c){if(b!=c&&!(b<0&&c<0)){var e=d.query(a,".bs-lv-content"),f=e.childNodes.length;b>=0&&b<f&&d.removeClass(e.childNodes[b],"active"),c>=0&&c<f&&d.addClass(e.childNodes[c],"active")}},r=function(a,b,c,e,h,k){var l=c.customRender?i.get(c.customRender):null;l||(l=j.get(c.context,"widget.listview.item"));var p=d.query(a,".bs-lv-content"),q=c.empty?null:c.basic?$(n).get(0):c.noLink?$(o).get(0):$(m).get(0),r=b?b.length:0,s=document.createDocumentFragment();q&&c.noBorders&&d.addClass(q,"no-border"),q&&c.inline&&(d.addClass(q,"no-radius"),d.addClass(q,"no-y-border"));for(var t={$item:null,$url:g.search(null,!1),$mem:f},u=0;u<r;u++){var v=b[u];if(q){var w=q.cloneNode(!0);if(!h||!h.default||c.basic||c.noLink||c.select||(t.$item=v,w.href=g.hashLink(h.default,t,null)),l){var x=[];l(x,e,c,u,v,k),w.appendChild($(x.join("")).get(0))}s.appendChild(w)}else if(l){var x=[];l(x,e,c,u,v,k);for(var y=$(x.join("")),z=0,A=y.length;z<A;z++)s.appendChild(y.get(z))}}return $(p).empty(),p.appendChild(s),a},s=function(a){return a.documents=a.documents||[],a.count=a.count,a.dataCount=a.documents.length,a.skip=a.skip||0,a.pageSize=a.pageSize||a.documents.length||20,a},t=function(a,b){return a.search=b.search||!1,a.inline=b.inline||!1,a.pagerSize=b.pagerSize||"lg",b.select&&(a.select=!0),b.link&&(a.link=b.link),a.basic=b.basic||!1,a.empty=b.empty||!1,a.noLink=b.noLink||!1,a.pagination=b.pagination||!1,a.customRender=b.customRender||"",a.customRootRender=b.customRootRender||"",a},u=function(){function a(a,b,c){var d=this,e=a;e.data=e.data||{},b=b||{},b.dataset=b.dataset||a.data.dataset||"items",b.dataType=b.dataType||"odata",d.options=t(b,a.data),d["_checkData"+b.dataType](e.data,b),d.data=e.data,d.selectedIndex=-2,d.props={},d._defineProps(),d.module=c,d.module.onDSChanged=d._afterDatasetChanged.bind(d),d.pager=new h.Pager({size:d.options.pagerSize,selectPage:d._onselectPage.bind(d)})}return a.prototype._defineProps=function(){var a=this;Object.defineProperty(a.props,"items",{get:function(){return a.data.ds[a.options.dataset].documents},set:function(b){a.data.ds[a.options.dataset].documents=b,a._notifyChange("items")},enumerable:!0})},a.prototype._afterDatasetChanged=function(a){var b=this;if(a.indexOf(b.options.dataset)>=0){if(b.options.beforeRemove&&b.options.beforeRemove(),b.options.select){var c=b.module.datasets[b.options.dataset];c&&(b.selectedIndex=c.selectedIndex)}b._renderItems(!0),b.$element&&b.options.select&&q(b.$element.get(0),-1,b.selectedIndex),b._updateNavigation()}},a.prototype._extractContextodata=function(){var a=this,b=a.data.ds[a.options.dataset]||{},c={};return b.dataCount&&(c.$dataCount=b.dataCount),b.count&&(c.$count=b.count),b.skip&&(c.$skip=b.skip),b.pageSize&&(c.$top=b.pageSize),b.searchText&&(c.$searchText=b.searchText),c},a.prototype._navigationState=function(){var a=this,b={currentPage:-1,totalPages:0};if(!a.options.pagination)return b;if("odata"==a.options.dataType){var c=a._extractContextodata();c.$skip=c.$skip||0,c.$count=c.$count||0,c.$dataCount=c.$dataCount||0,c.$top=c.$top||0,b.totalPages=c.$top<1?1:Math.ceil(c.$count/c.$top),b.currentPage=c.$top<1?1:Math.ceil(c.$skip/c.$top)+1}return b},a.prototype._notifyChange=function(a){},a.prototype._checkDataodata=function(a,b){a.ds=a.ds||{},a.ds[b.dataset]=a.ds[b.dataset]||{},s(a.ds[b.dataset])},a.prototype._removeEvents=function(){var a=this;a.$element.off("click keyup")},a.prototype._doSearch=function(){var a=this;if(a.module&&a.$element&&a.options.search){var b=a.$element.get(0),c=d.query(b,".bs-lv-search-input");if(c){var e=a["_extractContext"+a.options.dataType]();if(e.$searchText!=c.value){e.$skip=0,e.$searchText=c.value;var f=d.query(b,".bs-lv-nodata");f&&d.addClass(f,"bs-none"),a.module.execDataSet(a.options.dataset,e,function(b){b&&f&&a.props.items&&0==a.props.items.length&&d.removeClass(f,"bs-none")},null,!0)}}}},a.prototype._setEvents=function(){var a=this;a.$element&&a.$element.on("click",function(b){var c=b.target,e=this,f=d.query(e,".bs-lv-content"),h=d.query(e,".bs-lv-search-btn"),i=g.isCustomLink(e,b);if(i)return g.execCustomProtocol(i,a.module.ds_context(),{links:a.module.links},null);for(;c!=e;){if(c.href){var j=d.attr(c,"href");"#"===j&&(b.preventDefault(),b.stopPropagation())}if(c==h){a._doSearch();break}if(c.parentNode==f){var k=d.attr(c,"data-index");void 0===k&&(k=Array.prototype.indexOf.call(f.children,c)),a.options.select?a._selectItem(k):a.options.clickItem&&a._clickItem(b.target,c,k);break}c=c.parentNode}}).on("keyup",function(b){13==b.keyCode&&a._doSearch()})},a.prototype._renderItems=function(a){var b=this;if(b.$element){var c=b.data.ds.view?b.data.ds.view.$view:null,e=b.data.ds[b.options.dataset].documents;b.options.beforeRenderItems&&b.options.beforeRenderItems(e),r(b.$element.get(0),e,b.options,b.data.$type,b.module.links,c),b.options.afterRenderItems&&b.options.afterRenderItems(e,d.query(b.$element.get(0),".bs-lv-content")),b.options.beforeAdd&&b.options.beforeAdd(b.$element,a)}},a.prototype._clickItem=function(a,b,c){var d=this;d.props.items&&c>=0&&c<d.props.items.length&&d.options.clickItem&&d.options.clickItem(a,b,d.props.items[c],c),d.props.items[d.selectedIndex]},a.prototype._selectItem=function(a){var b=this;if(b.selectedIndex!=a&&(b.$element&&q(b.$element.get(0),b.selectedIndex,a),b.selectedIndex=a,b.module&&b.options.dataset)){var c=b.module.datasets[b.options.dataset];c&&(c.selectedIndex=a),b.module.ds_select(b.options.dataset,b.selectedIndex>=0?b.props.items[b.selectedIndex]:null)}},a.prototype._onselectPage=function(a){var b=this;switch(a){case"next":b.next();break;case"prev":b.previous();break;case"first":b.moveToPage(1);break;case"last":b.moveToPage(b.pager.props.totalPages);break;default:b.moveToPage(a)}},a.prototype.moveToPage=function(a){var b=this,c=b["_extractContext"+b.options.dataType]();c.$skip=(a-1)*(c.$top||0),b.module.execDataSet(b.options.dataset,c,null,null,!0)},a.prototype.next=function(){var a=this,b=a["_extractContext"+a.options.dataType]();b.$skip=(b.$skip||0)+(b.$top||0),a.module.execDataSet(a.options.dataset,b,null,null,!0)},a.prototype.previous=function(){var a=this,b=a["_extractContext"+a.options.dataType]();b.$skip=Math.max(0,(b.$skip||0)-(b.$top||0)),a.module.execDataSet(a.options.dataset,b,null,null,!0)},a.prototype._updateNavigation=function(){var a=this,b=a._navigationState();a.pager.props.totalPages=b.totalPages,a.pager.props.currentPage=b.currentPage},a.prototype.render=function(a){var b=this;if(!b.$element){var c=b.options.customRootRender?i.get(b.options.customRootRender):null;b.$element=p(!1,c?c():l);var e=b.$element.get(0);if(b.options.search){var f=d.query(e,".bs-lv-search");f&&d.removeClass(f,"bs-none")}var g=d.query(e,".bs-lv-pagination");if(b.pager.render($(g)),b._setEvents(),b.contentRender=j.get(this.options.context,"widget.content.control.listview."+b.data.$type),b.options.select){var h=b.module.datasets[b.options.dataset];h&&(b.selectedIndex=h.selectedIndex)}b._renderItems(!1),b.$element&&b.options.select&&q(b.$element.get(0),-1,b.selectedIndex),b._updateNavigation()}return a&&(b.options.replaceParent?a.replaceWith(b.$element):a.append(b.$element)),b.$element},a.prototype.destroy=function(){var a=this;a.pager&&(a.pager.destroy(),a.pager=null),a.module&&(a.module.onDSChanged=null,a.module=null),a.contentRender&&(a.contentRender.destroy(),a.contentRender=null),a.$element&&a._removeEvents(),a.$element=null},a}();b.ListView=u,j.register("javascript","widget.content.control.listview",u)}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var Phoenix;!function(a){var b;!function(a){var b=function(){function a(a,b){var c=this;c.options=a||{},c.callback=b||null,c.map=null,c.markerList=[]}return a.prototype.newMap=function(){return new a},a.prototype.getLatLng=function(a,b){},a.prototype.initMap=function(a,b){},a.prototype.setMapCenter=function(a,b,c,d){},a.prototype.addMarker=function(a,b,c,d,e){},a.prototype.removeMarker=function(a){},a.prototype.addMarkerByAddress=function(a){},a}();a.Map=b}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Phoenix;!function(a){var b;!function(a){var b=window.google,c=function(a){function c(b,c){return a.call(this,b,c)||this}return __extends(c,a),c.prototype.getLatLng=function(a,c){function d(b){b?c(b):g==a.length-1?c(null):(g++,e(a[g],d))}function e(a,c){f.geocode({address:a},function(d,e){return e===b.maps.GeocoderStatus.OK?c({latitude:d[0].geometry.location.lat(),longitude:d[0].geometry.location.lng(),libelle:a}):void c(null)})}var f=new b.maps.Geocoder;if(f){Array.isArray(a)||(a=[a]);var g=0;e(a[0],d)}},c.prototype.initMap=function(a,c){var d=this;if(a)return c=c||{},c={zoom:c.zoom||16,mapTypeId:c.type||b.maps.MapTypeId.TERRAIN,scrollwheel:!1},d.map=new b.maps.Map(a,c)},c.prototype.setMapCenter=function(a,c,d,e){if(a){var f=new b.maps.LatLng(c,d);a.setCenter(f)}},c.prototype.addMarker=function(a,c,d,e){var f=this;if(a){e=e||{};var g=new b.maps.LatLng(c,d),h=new b.maps.Marker({position:g,map:a,title:e.message||null});if(e.message){var i=new b.maps.InfoWindow({content:e.message,size:new b.maps.Size(100,100)});b.maps.event.addListener(h,"click",function(){i.open(a,h)})}return f.markerList[0]?f.markerList[0]=h:f.markerList.push(h),h}},c.prototype.removeMarker=function(a){a&&a.setMap(null)},c.prototype.addMarkerByAddress=function(a){var b=this;b.getLatLng(a,function(a){return a?(b.map&&(b.markerList[0]&&b.removeMarker(b.markerList[0]),b.setMapCenter(b.map,a.latitude,a.longitude),b.addMarker(b.map,a.latitude,a.longitude,{message:"<b>Adresse :</b><br />"+a.libelle})),void(b.callback&&b.callback(a))):b.callback&&b.callback(null)})},c}(a.Map);a.GoogleMaps=c,a.googleMaps=function(a,d){return b=window.google,new c(a,d)}}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Phoenix;!function(a){var b;!function(a){var b=window.google,c=window.L,d=function(a){function d(b,c){return a.call(this,b,c)||this}return __extends(d,a),d.prototype.getLatLng=function(a,c){function d(b){b?c(b):g==a.length-1?c(null):(g++,e(a[g],d))}function e(a,c){f.geocode({address:a},function(d,e){return e===b.maps.GeocoderStatus.OK?c({latitude:d[0].geometry.location.lat(),longitude:d[0].geometry.location.lng(),libelle:a}):void c(null)})}var f=new b.maps.Geocoder;if(f){Array.isArray(a)||(a=[a]);var g=0;e(a[0],d)}},d.prototype.initMap=function(a,b){var d=this;if(a){b=b||{};var e=c.map(a,{center:[0,0],zoom:b.zoom||16});return c.tileLayer(b.tile||"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw",{maxZoom:b.maxZoom||18,attribution:b.attribution||'&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',id:b.id||"mapbox.streets"}).addTo(e),d.map=e}},d.prototype.setMapCenter=function(a,b,d,e){if(a){var f=c.latLng(b,d);a.setView(f)}},d.prototype.addMarker=function(a,b,d,e){var f=this;if(a){e=e||{};var g=c.marker([b,d]).addTo(a);return e.message&&g.bindPopup(e.message),f.markerList[0]?f.markerList[0]=g:f.markerList.push(g),g}},d.prototype.removeMarker=function(a){var b=this;a&&b.map&&(a.closePopup(),b.map.removeLayer(a))},d.prototype.addMarkerByAddress=function(a){var b=this;b.getLatLng(a,function(a){return a?(b.map&&(b.markerList[0]&&b.removeMarker(b.markerList[0]),b.setMapCenter(b.map,a.latitude,a.longitude),b.addMarker(b.map,a.latitude,a.longitude,{message:"<b>Adresse :</b><br />"+a.libelle})),void(b.callback&&b.callback(a))):b.callback&&b.callback(null)})},d}(a.Map);a.OpenStreetMap=d,a.openStreetMap=function(a,e){return b=window.google,c=window.L,new d(a,e)}}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var Phoenix;!function(a){var b;!function(b){var c=a.WidgetUtils,d=a.utils,e=function(){function a(a,b){var c=this;c._options=a||{},c._options.id=c._options.id||d.allocID(),c._data=b||{}}return a.prototype.render=function(a){var b=this;if(!b.$element){var d=[];c.widgetTitle(d,b._options.id,b._data,null,!0),b.$element=$(d.join(""))}a&&(b._options.replaceParent?a.replaceWith(b.$element):a.append(b.$element))},a.prototype.destroy=function(){var a=this;a.$element=null,a._options=null,a._data=null},a}();b.ModuleTitle=e}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var Phoenix;!function(a){var b;!function(b){var c=a.ulocale,d=a.utils,e=(a.ajax,a.dom),f=a.link,g=a.render,h=function(){function a(a){var c=this;b.constructXRangeType(Highcharts),c._id=d.allocID(),c.data=a}return Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(a){var b=this;this._data=a,b._constructConfig(),b._chart&&b._internalReflow(!0)},enumerable:!0,configurable:!0}),a.prototype._onResize=function(){var a=this;a._internalReflow(!1)},a.prototype.destroy=function(){var a=this;a.$element&&(a.$element.off("click"),a.$element=null),a._config=null,a._chart&&(a._chart.destroy(),a._chart=null,$("#"+a._id).remove(),a._id=null),a._resizeHnd&&($(window).off("phoenix-resize",a._resizeHnd),a._resizeHnd=null)},a.prototype.drawLegend=function(a){var b=this;b._chart.series.forEach(function(b){var c=b.options;c.dataLabels.enabled=a,b.update(c)})},a.prototype._internalReflow=function(a){var b=this;a?b.renderChart():b._chart.reflow(),b._renderLabels()},a.prototype.render=function(a){var b=this;b._resizeHnd||(b._resizeHnd=function(){b._onResize()},$(window).on("phoenix-resize",b._resizeHnd)),b.$element||(b.$element=$(d.format('<div id="{0}" class=""></div>',b._id)),b.$element.on("click",function(a){var c=a.target,d=e.text(c);if(d){var g=b._getLinkByTitle(d);g&&"object"==typeof g&&(b.cbDelegateExecuteLink?b.cbDelegateExecuteLink(g):f.execLink(g,{},null))}}),a.append(b.$element)),b.renderChart()},a.prototype.renderChart=function(){var b=this,c=a.HEIGHT_FIX_PLANNING+b._data.boxes.length*(b._data.rows.length*a.HEIGHT_FIX_ROW+a.HEIGHT_FIX_BOX);b.$element.css("height",c+"px"),Highcharts.setParams(a.HEIGHT_FIX_BOX,a.HEIGHT_FIX_ROW,b._data.rows.length),Highcharts.setOptions({lang:{months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],shortMonths:["Jan","Fév","Mars","Avr","Mai","Juin","Juil","Août","Sept","Oct","Nov","Déc"]}}),b._chart=new Highcharts.Chart(b._config),b._renderLabels()},a.prototype._renderLabels=function(){var a=this;a._absoluteLabels&&a._absoluteLabels.forEach(function(a){a.remove()}),a._absoluteLabels=[];for(var b in a._chart.yAxis[0].ticks){var c=a._chart.yAxis[0].ticks[b];if(c.label){var d=c.label.xy.y+90,e=a._config.yAxis.categories[parseInt(b)];c.label.hide();var f=$('<div style="position: absolute; top: '+d+'px; left:15px; cursor: pointer;z-index: 0;">'+e+"</div>"),g=$('<div style="position: absolute; top: '+d+'px; left:15px; cursor: pointer;z-index:2;background-color:transparent;color:transparent;">'+e+"</div>");a._absoluteLabels.push(f),a._absoluteLabels.push(g)}}a._absoluteLabels.forEach(function(b){a.$element.append(b)});var h=a.$element.get(0).firstElementChild;h.style.zIndex=1},a.prototype._getRowName=function(a){var b=this,c="";return b._data.rows.forEach(function(b){b.id==a&&(c=b.title)}),c},a.prototype._getLinkByTitle=function(a){var b=this,c="";return b._data.boxes.forEach(function(b){b.link&&b.title==a&&(c=b.link)}),c},Object.defineProperty(a.prototype,"emptyConf",{get:function(){var b=this;return b._emptyConf={chart:{ignoreHiddenSeries:!1,backgroundColor:null},title:{text:null},legend:{enabled:!1},xAxis:{type:"datetime",dateTimeLabelFormats:{month:"%b %y"},plotLines:[{color:a.PLOT_LINE_COLOR,width:3,value:new Date,zIndex:4}],opposite:!0,minRange:1e3},yAxis:{title:"",categories:[],labels:{align:"left",x:0,y:0,formatter:function(){return this.value}},showFirstLabel:!0,min:0,max:0,tickPosition:"outside"},tooltip:{formatter:function(){var a="%d/%m/%Y",b="<b>"+this.point.title+"</b>";return this.point.x&&(b+="<br/><b>"+Highcharts.dateFormat(a,new Date(this.point.x))),this.point.x2&&this.point.x!=this.point.x2&&(b+=" - "+Highcharts.dateFormat(a,new Date(this.point.x2))),this.point.x&&(b+="</b>"),b},hideDelay:100,backgroundColor:"white",followPointer:!1},plotOptions:{xrange:{dataLabels:{enabled:!1,formatter:function(){return this.point.legend},style:{fontWeight:"normal",textShadow:"0 0 1px contrast, 0 0 1px contrast"}},states:{hover:{enabled:!1}}}},scrollbar:{enabled:!1},credits:{enabled:!1},series:[{data:[],visible:!1}]},b._emptyConf},enumerable:!0,configurable:!0}),a.getMillisHour=function(){return 36e5},a.getMillisDay=function(){return 24*a.getMillisHour()},a.getMillisMonth=function(){return 30*a.getMillisDay()},a.getMillisYear=function(){return 12*a.getMillisMonth()},a.addMillis=function(a,b){return new Date(a.getTime()+b)},a.getInterval=function(b){return b<=3*a.getMillisYear()?a.getMillisMonth():a.getMillisYear()},a.addDays=function(a,b){var c=new Date(a.valueOf());return c.setDate(c.getDate()+b),c},a.prototype.zoom=function(b){var c,d=this;c=a.getMillisDay()*b;var e=new Date,f=a.addDays(new Date(d._chart.xAxis[0].dataMin),-a.ADD_DAYS_SECURE),g=a.addDays(new Date(d._chart.xAxis[0].dataMax),a.ADD_DAYS_SECURE),h=g.valueOf()-f.valueOf(),i=100;b>0&&(i=h/c*100),i<100&&(i=100),d.$element.css("width",i+"%");var j=!0;b<=0&&(j=!1),d._config.tooltip.followPointer=j;var k=c<0?h:c;d._chart.xAxis[0].options.tickInterval=a.getInterval(k),d._chart.xAxis[0].setExtremes(Date.UTC(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDay()),Date.UTC(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDay())),d._internalReflow(!0);var l=0,m=parseInt(d.$element.css("width").replace("px","")),n=e.valueOf()-f.valueOf();if(n>0){l=n/h*m;var o=c/2/h*m;l-=o}d.$element.parent().parent().scrollLeft(l)},a.prototype._constructConfig=function(){var b=this;b._config=b.emptyConf,b._data.boxes.forEach(function(a){b._config.yAxis.categories.unshift(a.title)}),b._config.yAxis.max=b._data.boxes.length-1,b._config.yAxis.labels.y=-(b._data.rows.length*a.HEIGHT_FIX_ROW+a.HEIGHT_FIX_BOX/2-a.BOX_TITLE_PX)/2,b._config.yAxis.labels.formatter=function(){var c=b._getLinkByTitle(this.value),d="font-size:"+a.BOX_TITLE_PX+"px;font-weight:bold;cursor:pointer;";return"string"==typeof c?'<p><a href="'+c+'" style="'+d+'">'+this.value+"</a></p>":'<p style="'+d+'">'+this.value+"</p>"},b._config.chart?b._config.chart.renderTo=b._id:b._config.chart={renderTo:b._id};var d={};b._data.boxes.forEach(function(e,f){e.rows.forEach(function(e,g){e.segments.sort(function(a,b){return a.dtStart>b.dtStart?1:-1}),e.segments.forEach(function(g,h){var i=Math.random(),j=g.height?g.height:"default",k=g.color,l=g.borderColor?g.borderColor:a.BORDER_COLOR;"point"==g.style&&(l="black"),d[g.style]||(d[g.style]={}),d[g.style][j]||(d[g.style][j]={}),d[g.style][j][e.id]||(d[g.style][j][e.id]=[]),g.color2&&(k={linearGradient:a.LINEAR_GRADIENT,stops:[[0,g.color],[1,g.color2]]}),d[g.style][j][e.id].push({title:g.title,legend:g.legend||g.title,x:c.parseISODateAsUTC(g.dtStart)+i,x2:c.parseISODateAsUTC(g.dtEnd?g.dtEnd:g.dtStart)+i,y:b._data.boxes.length-(f+1),color:k,borderColor:l})})})});for(var e in d)for(var f in d[e])for(var g in d[e][f]){var h=0,i="small"==f?a.SERIE_STYLE_SMALL_HEIGHT:a.SERIE_STYLE_HEIGHT,j=a.BORDER_WIDTH,k=a.Z_INDEX_DEFAULT;"default"==e&&(h=a.BORDER_RADIUS_DEFAULT),"point"==e?(j=3,h=a.BORDER_RADIUS_DEFAULT,i=a.SERIE_STYLE_SMALL_HEIGHT,k=a.Z_INDEX_POINT):"line"==e&&(k=a.Z_INDEX_LINE),b._config.series.push({type:"xrange",dataType:e,stacking:!0,name:b._getRowName(g),z:g,data:d[e][f][g],borderWidth:j,borderRadius:h,pointWidth:i,zIndex:k})}},a}();h.HEIGHT_FIX_PLANNING=100,h.HEIGHT_FIX_BOX=30,h.HEIGHT_FIX_ROW=30,h.Z_INDEX_POINT=30,h.Z_INDEX_LINE=20,h.Z_INDEX_DEFAULT=10,h.LINEAR_GRADIENT={x1:0,y1:0,x2:1.2,y2:0},h.BORDER_COLOR="white",h.BORDER_WIDTH=1,h.BOX_TITLE_PX=12,h.SERIE_STYLE_HEIGHT=25,h.SERIE_STYLE_SMALL_HEIGHT=10,h.BORDER_RADIUS_DEFAULT=10,h.PLOT_LINE_COLOR="#5E6165",h.ADD_DAYS_SECURE=30,b.PlanningChart=h,g.register("javascript","widget.content.control.planningchart",h)}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var Phoenix;!function(a){var b;!function(a){function b(a){function b(a){var b={};return a.forEach(function(a){var c=a.y+"",d=b[c]=b[c]||[];if(a.offsetY=0,"point"!=a.style&&"line"!=a.style){var e=d.length?d[d.length-1]:null;e&&e.x2>a.x&&(a.offsetY=2)}d.push(a)}),b}if(!a.seriesTypes.xrange){var c,d,e,f=a.getOptions().plotOptions,g=a.seriesTypes.column,h=a.each;f.xrange=a.merge(f.column,{}),a.seriesTypes.xrange=a.extendClass(g,{type:"xrange",parallelArrays:["x","x2","y"],
requireSorting:!1,animate:a.seriesTypes.line.prototype.animate,getColumnMetrics:function(){function a(){h(c.series,function(a){var b=a.xAxis;a.xAxis=a.yAxis,a.yAxis=b})}var b,c=this.chart;return a(),this.yAxis.closestPointRange=1,b=g.prototype.getColumnMetrics.call(this),a(),b},translate:function(){g.prototype.translate.apply(this,arguments);var f=this,h=f.xAxis,i=f.columnMetrics,j=b(f.points);Object.keys(j).forEach(function(b){var f=j[b],g=0;a.each(f,function(b){var f=h.translate(a.pick(b.x2,b.x+(b.len||0)))-b.plotX;g+=b.offsetY;var j=b.plotY-(c/2+e/2*d)+d/2;b.shapeArgs={x:b.plotX,y:j+parseInt(b.series.options.z+"")*d+3*c/4+i.offset+g,width:Math.max(f,i.width),height:i.width},b.tooltipPos[0]+=f/2,b.tooltipPos[1]-=i.width/2-parseInt(b.series.options.z+"")*d})})}}),a.wrap(a.Axis.prototype,"getSeriesExtremes",function(a){var b=this,c=Number.MIN_VALUE;a.call(this),this.isXAxis&&(h(this.series,function(a){"xrange"==a.stackKey&&h(a.x2Data||[],function(a,b){a>c&&(c=a)})}),c>Number.MIN_VALUE&&(b.dataMax=c))}),a.setParams=function(a,b,f){c=a,d=b,e=f}}}a.constructXRangeType=b}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));var Phoenix;!function(a){var b;!function(b){var c=(a.utils,a.render),d=function(){function a(a,b){this.data=a||{},this.options=b||{}}return a.prototype.render=function(a){var b=this;return b.$element||(b.$element=$("<div></div>")),a&&(b.options.beforeAdd&&b.options.beforeAdd(b.$element),b.options.replaceParent?a.replaceWith(b.$element):a.append(b.$element)),b.$element},a.prototype.destroy=function(){var a=this;a.$element=null},a}();c.register("javascript","widget.content.control.test",d)}(b=a.ui||(a.ui={}))}(Phoenix||(Phoenix={}));
//# sourceMappingURL=phoenix.widgets.min.js.map